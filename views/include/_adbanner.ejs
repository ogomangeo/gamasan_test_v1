<!-- views/include/_adbanner.ejs -->
<div class="adbanner">
  <div class="colored-box adbanner1">Crimson<br>#DC143C</div>
  <div class="colored-box adbanner2">DodgerBlue<br>#1E90FF</div>
  <div class="colored-box adbanner3">SpringGreen<br>#00FF7F</div>
  <div class="colored-box adbanner4">
          <!-- ìŠ¬ë¡¯ë¨¸ì‹  ì½”ë“œ ì‹œì‘ -->
          <style>
            .slot-machine {
              flex: 1;
              background: linear-gradient(145deg, #282828, #1a1a1a);
              border-radius: 8px;
              text-align: center;
              display: flex;
              flex-direction: column;
              align-items: center;
              justify-content: space-between;
              overflow: hidden;
            }
        
            .slot-slot-title {
              color: gold;
              font-size: 12px;
              margin: 15px 0;
            }
        
            .slot-header-bar {
              width: 95%;
              height: 4px;
              background: #555;
              border-radius: 2px;
              overflow: hidden;
              position: relative;
              margin: 5px 0;
            }
        
            .slot-header-bar-inner {
              height: 100%;
              background: linear-gradient(145deg, #ffd700, #ffaa00);
              border-radius: 2px;
              width: 0;
              transition: width 3s linear;
            }
        
            .slot-reels {
              display: grid;
              grid-template-columns: repeat(3, 50px);
              grid-template-rows: repeat(3, 50px);
              gap: 5px;
              margin: 10px auto;
            }
        
            .slot-reel {
              width: 50px;
              height: 50px;
              background: #fff;
              border-radius: 4px;
              display: flex;
              justify-content: center;
              align-items: center;
              font-size: 16px;
              color: #333;
              box-shadow: 0 0 3px rgba(0, 0, 0, 0.1);
              overflow: hidden;
            }
        
            .slot-button-group {
              display: flex;
              gap: 10px;
              margin: 10px 0;
              justify-content: center;
              width: 80%;
            }
        
            .slot-btn-spin,
            .slot-btn-reset {
              flex: 1;
              color: #fff;
              border: none;
              border-radius: 4px;
              padding: 8px 16px;
              font-size: 12px;
              cursor: pointer;
              transition: background 0.3s;
              min-width: 80px;
            }
        
            .slot-btn-spin {
              background: linear-gradient(145deg, #0066cc, #0044aa);
            }
        
            .slot-btn-spin:hover {
              background: linear-gradient(145deg, #0044aa, #0066cc);
            }
        
            .slot-btn-reset {
              background: linear-gradient(145deg, #dc3545, #c82333);
            }
        
            .slot-btn-reset:hover {
              background: linear-gradient(145deg, #c82333, #dc3545);
            }
        
            .slot-btn-spin:disabled,
            .slot-btn-reset:disabled {
              background: #ccc;
              cursor: not-allowed;
            }
        
            .slot-spin-count {
              font-size: 12px;
              margin: 5px 0;
              color: #fff;
            }
        
            .slot-result {
              min-height: 14px;
              margin: 5px 0;
              font-size: 12px;
              color: #fff;
            }
        
            .slot-results {
              display: grid;
              grid-template-columns: repeat(4, 1fr);
              gap: 5px;
              font-size: 12px;
              width: 90%;
              margin: 5px auto;
            }
        
            .slot-results p {
              margin: 0;
              padding: 2px;
              color: white;
            }
        
            .slot-highlight {
              animation: slot-pulse 1s infinite;
            }
        
            @keyframes slot-pulse {
              0% {
                transform: scale(1);
              }
        
              50% {
                transform: scale(1.05);
              }
        
              100% {
                transform: scale(1);
              }
            }
        
            .slot-flash {
              animation: slot-flash 1s forwards;
            }
        
            @keyframes slot-flash {
        
              0%,
              100% {
                background-color: #ffd700;
              }
        
              50% {
                background-color: #ffea00;
              }
            }
        
            @keyframes slot-colorChange {
              0% {
                background: linear-gradient(145deg, #ff6b6b, #ff4757);
              }
        
              12.5% {
                background: linear-gradient(145deg, #feca57, #ff9ff3);
              }
        
              25% {
                background: linear-gradient(145deg, #54a0ff, #5f27cd);
              }
        
              37.5% {
                background: linear-gradient(145deg, #2ecc71, #1abc9c);
              }
        
              50% {
                background: linear-gradient(145deg, #f1c40f, #e67e22);
              }
        
              62.5% {
                background: linear-gradient(145deg, #9b59b6, #8e44ad);
              }
        
              75% {
                background: linear-gradient(145deg, #3498db, #2980b9);
              }
        
              87.5% {
                background: linear-gradient(145deg, #e74c3c, #c0392b);
              }
        
              100% {
                background: linear-gradient(145deg, #2ecc71, #00ffab);
              }
            }
        
            .slot-machine.slot-win {
              animation: slot-colorChange 8s linear infinite;
            }
          </style>
          <div class="slot-machine">
            <h2 class="slot-slot-title">ğŸ€ Check Today your Luck! ğŸŒˆ</h2>
            <div class="slot-header-bar">
              <div class="slot-header-bar-inner" id="headerBarInner"></div>
            </div>
            <div class="slot-reels">
              <div class="slot-reel" id="reel1">ğŸ’</div>
              <div class="slot-reel" id="reel2">ğŸ’</div>
              <div class="slot-reel" id="reel3">ğŸ’</div>
              <div class="slot-reel" id="reel4">ğŸ’</div>
              <div class="slot-reel" id="reel5">ğŸ’</div>
              <div class="slot-reel" id="reel6">ğŸ’</div>
              <div class="slot-reel" id="reel7">ğŸ’</div>
              <div class="slot-reel" id="reel8">ğŸ’</div>
              <div class="slot-reel" id="reel9">ğŸ’</div>
            </div>
            <div class="slot-button-group">
              <button class="slot-btn-spin" id="spinButton">ìŠ¤í•€!</button>
              <button class="slot-btn-reset" id="resetButton">ì´ˆê¸°í™”</button>
            </div>
            <span class="slot-spin-count" id="spinCount">0ë²ˆ ìŠ¤í•€</span>
            <p class="slot-result" id="result"></p>
            <div class="slot-results" id="results">
              <p>ğŸ’: <span id="cherryCount">0</span></p>
              <p>ğŸ‹: <span id="lemonCount">0</span></p>
              <p>ğŸ‰: <span id="watermelonCount">0</span></p>
              <p>ğŸ€: <span id="cloverCount">0</span></p>
              <p>ğŸŒˆ: <span id="rainbowCount">0</span></p>
              <p>ğŸš€: <span id="rocketCount">0</span></p>
              <p>ğŸ: <span id="giftCount">0</span></p>
              <p>ğŸ‹: <span id="whaleCount">0</span></p>
            </div>
          </div>
          <script>
            const reelSymbols = ["ğŸ’", "ğŸ‹", "ğŸ‰", "ğŸ€", "ğŸŒˆ", "ğŸš€", "ğŸ", "ğŸ‹"];
            const spinButton = document.getElementById("spinButton");
            const resetButton = document.getElementById("resetButton"); // ì¶”ê°€
            const result = document.getElementById("result");
            const reels = Array.from(document.getElementsByClassName("slot-reel"));
            const spinCountElement = document.getElementById("spinCount");
            const headerBarInner = document.getElementById("headerBarInner");
        
            const symbolCounts = {
              "ğŸ’": 0, "ğŸ‹": 0, "ğŸ‰": 0, "ğŸ€": 0,
              "ğŸŒˆ": 0, "ğŸš€": 0, "ğŸ": 0, "ğŸ‹": 0,
            };
        
            const symbolCountElements = {
              "ğŸ’": document.getElementById("cherryCount"),
              "ğŸ‹": document.getElementById("lemonCount"),
              "ğŸ‰": document.getElementById("watermelonCount"),
              "ğŸ€": document.getElementById("cloverCount"),
              "ğŸŒˆ": document.getElementById("rainbowCount"),
              "ğŸš€": document.getElementById("rocketCount"),
              "ğŸ": document.getElementById("giftCount"),
              "ğŸ‹": document.getElementById("whaleCount"),
            };
        
            let spinCounter = 0;
            let isWinState = false;
            let winAnimationTimeout;
        
            function resetCounters() {
              spinCounter = 0;
              updateSpinCount();
              for (let symbol in symbolCounts) {
                symbolCounts[symbol] = 0;
                symbolCountElements[symbol].textContent = "0";
              }
            }
        
            function updateSpinCount() {
              spinCountElement.textContent = `${spinCounter}ë²ˆ ìŠ¤í•€`;
            }
        
            function spinReels() {
              return new Promise((resolve) => {
                const spinDuration = 1000;
                const startTime = Date.now();
        
                function updateReels() {
                  const elapsedTime = Date.now() - startTime;
                  const progress = Math.min(elapsedTime / spinDuration, 1);
                  const speed = Math.sin(progress * Math.PI);
        
                  reels.forEach((reel) => {
                    if (Math.random() < speed) {
                      const randomSymbol = reelSymbols[Math.floor(Math.random() * reelSymbols.length)];
                      reel.textContent = randomSymbol;
                    }
                  });
        
                  if (progress < 1) {
                    requestAnimationFrame(updateReels);
                  } else {
                    resolve();
                  }
                }
        
                updateReels();
              });
            }
        
            function animateHeaderBar() {
              headerBarInner.style.transition = 'none';
              headerBarInner.style.width = "0";
              headerBarInner.classList.remove('slot-flash');
              setTimeout(() => {
                headerBarInner.style.transition = 'width 1s linear';
                headerBarInner.style.width = "100%";
                headerBarInner.addEventListener('transitionend', () => {
                  headerBarInner.classList.add('slot-flash');
                }, { once: true });
              }, 50);
            }
        
            async function spin() {
              if (isWinState) {
                document.querySelector('.slot-machine').classList.remove('slot-win');
              }
        
              if (winAnimationTimeout) {
                clearTimeout(winAnimationTimeout);
              }
        
              spinButton.disabled = true;
              result.textContent = "";
              reels.forEach(reel => reel.classList.remove("slot-highlight"));
        
              animateHeaderBar();
              await spinReels();
        
              const finalSymbols = reels.map(reel => reel.textContent);
              updateSymbolCounts(finalSymbols);
        
              spinCounter++;
              updateSpinCount();
        
              checkWin(finalSymbols);
        
              spinButton.disabled = false;
            }
        
            function updateSymbolCounts(symbols) {
              symbols.forEach(symbol => {
                symbolCounts[symbol]++;
                symbolCountElements[symbol].textContent = symbolCounts[symbol];
              });
            }
        
            function checkWin(symbols) {
              const winningCombination = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8],
                [0, 3, 6], [1, 4, 7], [2, 5, 8],
                [0, 4, 8], [2, 4, 6],
              ];
        
              const isWin = winningCombination.some(combination =>
                combination.every(index => symbols[index] === symbols[combination[0]])
              );
        
              if (isWin) {
                result.textContent = "ì¶•í•˜í•©ë‹ˆë‹¤! ìŠ¹ë¦¬í–ˆìŠµë‹ˆë‹¤!ğŸ‰";
                highlightWinningCombination(symbols, winningCombination);
                isWinState = true;
                document.querySelector('.slot-machine').classList.add('slot-win');
              } else {
                result.textContent = "ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”!ğŸ”¥";
              }
            }
        
            function highlightWinningCombination(symbols, winningCombination) {
              winningCombination.forEach(combination => {
                if (combination.every(index => symbols[index] === symbols[combination[0]])) {
                  combination.forEach(index => reels[index].classList.add("slot-highlight"));
                }
              });
            }
        
            function resetGame() {
              // ê¸°ì¡´ ì¹´ìš´í„° ì´ˆê¸°í™”
              resetCounters();
              isWinState = false;
        
              // ìŠ¬ë¡¯ë¨¸ì‹  íš¨ê³¼ ì œê±°
              document.querySelector('.slot-machine').classList.remove('slot-win');
        
              // ëª¨ë“  ë¦´ ì´ˆê¸° ìƒíƒœë¡œ
              reels.forEach(reel => {
                reel.textContent = "ğŸ’";
                reel.classList.remove("slot-highlight");
              });
        
              // ê²°ê³¼ í…ìŠ¤íŠ¸ ì´ˆê¸°í™”
              result.textContent = "";
        
              // í—¤ë”ë°” ì´ˆê¸°í™”
              headerBarInner.style.transition = 'none';
              headerBarInner.style.width = "0";
              headerBarInner.classList.remove('slot-flash');
        
              // ë²„íŠ¼ ìƒíƒœ ì´ˆê¸°í™”
              spinButton.disabled = false;
            }
        
            window.onload = function () {
              resetGame();
            };
        
            spinButton.addEventListener("click", function (e) {
              e.preventDefault();
              spin();
            });
        
            // ì´ˆê¸°í™” ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            resetButton.addEventListener("click", function (e) {
              e.preventDefault();
              resetGame();
            });
          </script>
          <!-- ìŠ¬ë¡¯ë¨¸ì‹  ì½”ë“œ ë -->
  </div>
</div>